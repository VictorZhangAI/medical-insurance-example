<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>服务设施项目信息管理</title>
<link rel="icon" href="./pictures/logo.ico" type="image/ico">
<meta name="keywords" content="LightYear,光年,后台模板,后台管理系统,光年HTML模板">
<meta name="description" content="LightYear是一个基于Bootstrap v3.3.7的后台管理系统的HTML模板。">
<meta name="author" content="yinqi">
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/materialdesignicons.min.css" rel="stylesheet">
<link href="css/style.min.css" rel="stylesheet">
</head>
  
<body>
<div class="lyear-layout-web">
  <div class="lyear-layout-container">
    <!--左侧导航-->
    <aside class="lyear-layout-sidebar">
      <!-- logo -->
      <div id="logo" class="sidebar-header">
        <a href="login.html"><img src="./pictures/logo.ico" title="LightYear" alt="LightYear" /><span style="margin-left: 1em;">医疗保险管理系统</span></a>
      </div>
      <div class="lyear-layout-sidebar-scroll"> 
        <nav class="sidebar-main">
          <ul class="nav nav-drawer">
            <li class="nav-item"> <a href="main.html"><i class="mdi mdi-home"></i> 后台首页</a> </li>
            <li class="nav-item nav-item-has-subnav active">
              <a href="javascript:void(0)"><i class="mdi mdi-palette"></i>医疗基本信息维护</a>
              <ul class="nav nav-subnav">
                <li> <a href="medicine.html">药品信息管理</a> </li>
                <li> <a href="medicine_add.html">添加药品信息</a> </li>
                <li> <a href="diagnosis.html">诊疗项目信息管理</a> </li>
                <li> <a href="diagnosis_add.html">添加诊疗项目信息</a> </li>
                <li class="active"> <a href="service_facilities.html">服务设施项目信息管理</a> </li>
                <li> <a href="service_facilities_add.html">添加服务设施项目信息</a> </li>
                <li> <a href="medical_institution.html">定点医疗机构信息管理</a> </li>
                <li> <a href="medical_institution_add.html">添加定点医疗机构信息</a> </li>
                <li> <a href="disease_info.html">病种信息维护</a> </li>
                <li> <a href="treatment_param.html">医疗待遇计算参数维护</a> </li>
              </ul>
            </li>
            <li class="nav-item nav-item-has-subnav">
              <a href="javascript:void(0)"><i class="mdi mdi-format-align-justify"></i> 医保待遇审批</a>
              <ul class="nav nav-subnav"></ul>
            </li>
            <li class="nav-item nav-item-has-subnav">
              <a href="javascript:void(0)"><i class="mdi mdi-file-outline"></i> 公共业务</a>
              <ul class="nav nav-subnav"></ul>
            </li>
            <li class="nav-item nav-item-has-subnav">
              <a href="javascript:void(0)"><i class="mdi mdi-language-javascript"></i> 医保中心报销</a>
              <ul class="nav nav-subnav"></ul>
            </li>
            <li class="nav-item nav-item-has-subnav">
              <a href="javascript:void(0)"><i class="mdi mdi-menu"></i> 信息查询</a>
              <ul class="nav nav-subnav"></ul>
            </li>
          </ul>
        </nav>
        <div class="sidebar-footer">
          <p class="copyright">Copyright © 2025 <a>HITWH-QD group 12</a>. All rights reserved.</p>
        </div>
      </div>
    </aside>
    <!--End 左侧导航-->
    
    <!--头部信息-->
    <header class="lyear-layout-header">
      <nav class="navbar navbar-default">
        <div class="topbar">
          <div class="topbar-left">
            <div class="lyear-aside-toggler">
              <span class="lyear-toggler-bar"></span>
              <span class="lyear-toggler-bar"></span>
              <span class="lyear-toggler-bar"></span>
            </div>
            <span class="navbar-page-title"> 服务设施项目信息管理 </span>
          </div>
          <ul class="topbar-right">
            <li class="dropdown dropdown-profile">
              <a href="javascript:void(0)" data-toggle="dropdown">
                <span>用户名 <span class="caret"></span></span>
              </a>
              <ul class="dropdown-menu dropdown-menu-right">
                <li> <a href="lyear_pages_profile.html"><i class="mdi mdi-account"></i> 个人信息</a> </li>
                <li> <a href="lyear_pages_edit_pwd.html"><i class="mdi mdi-lock-outline"></i> 修改密码</a> </li>
                <li> <a href="javascript:void(0)"><i class="mdi mdi-delete"></i> 清空缓存</a></li>
                <li class="divider"></li>
                <li> <a href="lyear_pages_login.html"><i class="mdi mdi-logout-variant"></i> 退出登录</a> </li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </header>
    <!--End 头部信息-->
    
    <!--页面主要内容-->
    <main class="lyear-layout-content">
        <div class="card">
              <div class="card-header"><h4>服务设施项目信息输入</h4></div>
              <div class="card-body">
                <form action="#" method="post" onsubmit="return false;">
                  <div class="form-group row">
                    <label for="serName" class="col-xs-2 control-label">服务设施名称</label>
                    <div class="col-xs-4">
                      <input class="form-control" type="text" id="serName" name="serName" placeholder="请输入服务设施名称..">
                    </div>
                    <label for="serID" class="col-xs-2 control-label">医疗服务设施编码</label>
                    <div class="col-xs-4">
                      <input class="form-control" type="text" id="serID" name="serID" placeholder="请输入医疗服务设施编码..">
                    </div>
                  </div>
                  <div class="form-group" style="margin-left: 25em; margin-right: 25em;">
                    <button class="btn btn-primary" type="submit">模糊查询</button>
                    <button class="btn btn-default" type="submit">清空查询</button>
                  </div>
                </form>
              </div>
            </div>
        <div class="row">
          <div class="col-lg-12">
            <div class="card">
              <div class="card-header">
                <h4>服务设施项目信息（点击服务设施名称查看更多信息）</h4>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-hover">
                    <thead>
                      <tr>
                        <th>医疗服务设施编码</th>
                        <th>服务设施名称</th>
                        <th>收费类别</th>
                        <th>开始日期</th>
                        <th>终止日期</th>
                        <th>有效标志</th>
                        <th>操作</th>
                      </tr>
                    </thead>
                    <tbody id="service-facilities-table-body">
                      <!-- 数据由 JS 动态渲染 -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <!--End 页面主要内容-->
  </div>
</div>
<!-- 编辑服务设施Modal -->
<div class="modal fade" id="serviceFacilitiesEditModal" tabindex="-1" role="dialog" aria-labelledby="serviceFacilitiesEditModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="serviceFacilitiesEditModalLabel">编辑服务设施项目信息</h4>
      </div>
      <div class="modal-body">
        <form id="service-facilities-edit-form">
          <input type="hidden" id="edit-serID" name="serID">
          <div class="form-group">
            <label for="edit-serName">服务设施名称</label>
            <input type="text" class="form-control" id="edit-serName" name="serName">
          </div>
          <div class="form-group">
            <label for="edit-serExpType">收费类别</label>
            <input type="text" class="form-control" id="edit-serExpType" name="serExpType">
          </div>
          <div class="form-group">
            <label for="edit-serStarttime">开始日期</label>
            <input type="date" class="form-control" id="edit-serStarttime" name="serStarttime">
          </div>
          <div class="form-group">
            <label for="edit-serEndtime">终止日期</label>
            <input type="date" class="form-control" id="edit-serEndtime" name="serEndtime">
          </div>
          <div class="form-group">
            <label for="edit-serValid">有效标志</label>
            <select class="form-control" id="edit-serValid" name="serValid">
              <option value="1">有效</option>
              <option value="0">无效</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" id="save-service-facilities-edit">保存</button>
      </div>
    </div>
  </div>
</div>
<!-- 删除确认Modal -->
<div class="modal fade" id="serviceFacilitiesDeleteModal" tabindex="-1" role="dialog" aria-labelledby="serviceFacilitiesDeleteModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="serviceFacilitiesDeleteModalLabel">确认删除</h4>
      </div>
      <div class="modal-body">
        <p>确定要删除该服务设施项目信息吗？</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-danger" id="confirm-service-facilities-delete">删除</button>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/perfect-scrollbar.min.js"></script>
<script type="text/javascript" src="js/main.min.js"></script>
<script type="text/javascript">
$(function() {
    function fetchServiceFacilities(serName, serID) {
        var params = {};
        if (serName) params.serName = serName;
        if (serID) params.serID = serID;
        $.get('/api/service-facilities', params, function(data) {
            var tbody = '';
            data.forEach(function(item) {
                tbody += '<tr>' +
                    '<td>' + (item.serId || '') + '</td>' +
                    '<td>' + (item.serName || '') + '</td>' +
                    '<td>' + (item.serExpType || '') + '</td>' +
                    '<td>' + (item.serStarttime ? item.serStarttime.substring(0, 10) : '') + '</td>' +
                    '<td>' + (item.serEndtime ? item.serEndtime.substring(0, 10) : '') + '</td>' +
                    '<td>' + (item.serValid ? '有效' : '无效') + '</td>' +
                    '<td>' +
                    '<button class="btn btn-xs btn-warning service-facilities-edit-btn" data-id="' + (item.serId || '') + '">编辑</button> ' +
                    '<button class="btn btn-xs btn-danger service-facilities-delete-btn" data-id="' + (item.serId || '') + '">删除</button>' +
                    '</td>' +
                '</tr>';
            });
            $('#service-facilities-table-body').html(tbody);
        });
    }
    fetchServiceFacilities();
    // 查询按钮
    $('.btn-primary[type="submit"]').off('click').on('click', function(e) {
        e.preventDefault();
        var name = $('#serName').val();
        var id = $('#serID').val();
        fetchServiceFacilities(name, id);
    });
    // 清空按钮
    $('.btn-default[type="submit"]').off('click').on('click', function(e) {
        e.preventDefault();
        $('#serName').val('');
        $('#serID').val('');
        fetchServiceFacilities();
    });
    // 编辑按钮事件
    $(document).on('click', '.service-facilities-edit-btn', function() {
        var serId = $(this).data('id');
        $.get('/api/service-facilities/' + serId, function(item) {
            $('#edit-serID').val(item.serId);
            $('#edit-serName').val(item.serName);
            $('#edit-serExpType').val(item.serExpType);
            $('#edit-serStarttime').val(item.serStarttime ? item.serStarttime.substring(0, 10) : '');
            $('#edit-serEndtime').val(item.serEndtime ? item.serEndtime.substring(0, 10) : '');
            $('#edit-serValid').val(item.serValid ? '1' : '0');
            $('#serviceFacilitiesEditModal').modal('show');
        });
    });
    // 保存编辑
    $('#save-service-facilities-edit').off('click').on('click', function() {
        var data = {
            serID: $('#edit-serID').val(),
            serName: $('#edit-serName').val(),
            serExpType: $('#edit-serExpType').val(),
            serStarttime: $('#edit-serStarttime').val(),
            serEndtime: $('#edit-serEndtime').val(),
            serValid: $('#edit-serValid').val()
        };
        $.ajax({
            url: '/api/service-facilities/' + data.serID,
            type: 'PUT',
            contentType: 'application/json',
            data: JSON.stringify(data),
            success: function(res) {
                $('#serviceFacilitiesEditModal').modal('hide');
                alert('修改成功！');
                fetchServiceFacilities();
            },
            error: function() {
                alert('修改失败，请检查输入或稍后重试！');
            }
        });
    });
    // 删除按钮事件
    var deleteSerId = null;
    $(document).on('click', '.service-facilities-delete-btn', function() {
        deleteSerId = $(this).data('id');
        $('#serviceFacilitiesDeleteModal').modal('show');
    });
    // 确认删除
    $('#confirm-service-facilities-delete').off('click').on('click', function() {
        if (!deleteSerId) return;
        $.ajax({
            url: '/api/service-facilities/' + deleteSerId,
            type: 'DELETE',
            success: function() {
                $('#serviceFacilitiesDeleteModal').modal('hide');
                alert('删除成功！');
                fetchServiceFacilities();
            },
            error: function() {
                alert('删除失败，请稍后重试！');
            }
        });
    });
});
</script>
</body>
</html> 